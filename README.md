# Generating CATH assignments for large sequence datasets
  
## 1. Create a new project

Clone a new project template from GitHub and move into the directory.

```
> git clone https://github.com/UCLOrengoGroup/cath-tools-genomescan.git myproject
> cd myproject/
> pwd
```

Note: this directory will be called ```${PROJECTHOME}``` for the rest of the tutorial.

## 2. Organise your query sequences

Choose a genome and get all translated protein sequences in FASTA format. 

The file ```${PROJECTHOME}/data/test.fasta``` has been included in the template as an example.

## 3. Download and install HMMER3

Download and extract the HMMER3 software:

```
> cd ${PROJECTHOME}
> cd apps/
> wget http://eddylab.org/software/hmmer3/3.1b2/hmmer-3.1b2-linux-intel-x86_64.tar.gz
> tar zxf hmmer-3.1b2-linux-intel-x86_64.tar.gz
```

Create a link for convenience:

```
> cd ${PROJECTHOME}
> cd bin/
> ln -s ../apps/hmmer-3.1b2-linux-intel-x86_64/binaries hmmer3
```

Check to make sure the link and binaries work as expected:

```
> cd ${PROJECTHOME}
> ./bin/hmmer3/hmmscan -h
# hmmscan :: search sequence(s) against a profile database
# HMMER 3.1b2 (February 2015); http://hmmer.org/
# Copyright (C) 2015 Howard Hughes Medical Institute.
# Freely distributed under the GNU General Public License (GPLv3).
# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Usage: hmmscan [-options] <hmmdb> <seqfile>
...
```

More information can be found on installing HMMER3 on the excellent [HMMER documentation](http://hmmer.org/documentation.html)

## 4. Download library of CATH models

Download the library of CATH FunFam (Functional Family) models and unzip:

```
> cd ${PROJECTHOME}
> cd data/
> wget http://download.cathdb.info/cath/releases/all-releases/v4_1_0/sequence-data/funfam-hmm3-v4_1_0.lib.gz
> gunzip funfam-hmm3-v4_1_0.lib.gz
```

Use ```hmmpress``` to index the HMM library:

```
> cd ${PROJECTHOME}
> cd data/
> ../bin/hmmer3/hmmpress funfam-hmm3-v4_1_0.lib
```

## 5. Scan the query sequences

CATH FunFam assignments can now be generated by scanning the query sequences against the CATH FunFam model library. Only those which meet the FunFam inclusion threshold are reported.

```
> cd ${PROJECTHOME}
> ./apps/cath-tools-genomescan.pl -i data/test.fasta -l data/funfam-hmm3-v4_1_0.lib -o results/
```

TODO: More details here

## 6. Results

TODO: More details here

# Relevant Links:

1. [Functional classification of CATH superfamilies: a domain-based approach for protein function annotation](https://doi.org/10.1093/bioinformatics/btv398)

2. [CATH FunFHMMer web server: protein functional annotations using functional family assignments](https://doi.org/10.1093/nar/gkv488)

3. [HMMER3 User Manual](ftp://ftp.hgc.jp/pub/mirror/wustl/hmmer3/3.1b1/Userguide.pdf)

